# –£–ª—É—á—à–µ–Ω–∏—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –≤—Å–µ —É–ª—É—á—à–µ–Ω–∏—è, –≤–Ω–µ—Å–µ–Ω–Ω—ã–µ –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –∏–¥–µ–∞–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Å–∏—Å—Ç–µ–º—ã –¥—Ä—É–≥ —Å –¥—Ä—É–≥–æ–º.

## üìã –û–±–∑–æ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π

### 1. Health Check Endpoints

#### Backend (`/health`)
- **–ü—Ä–æ—Å—Ç–æ–π health check**: `/health` - –±—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
- **–î–µ—Ç–∞–ª—å–Ω—ã–π health check**: `/health/detailed` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ (Analyz)
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç–∞—Ç—É—Å `healthy`, `degraded` –∏–ª–∏ `unhealthy`

#### Analyz (`/health`)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–∞–Ω–Ω—ã—Ö
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç JSON —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Å–æ—Å—Ç–æ—è–Ω–∏–∏

### 2. Docker Health Checks

–û–±–Ω–æ–≤–ª–µ–Ω `docker-compose.yml`:
- **Backend**: –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥ —á–µ—Ä–µ–∑ `/health`
- **Frontend**: –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ nginx
- **Analyz**: –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ `/health` endpoint
- **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**: —Å–µ—Ä–≤–∏—Å—ã –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ health check –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

### 3. Graceful Shutdown

Backend —Ç–µ–ø–µ—Ä—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞–≤–µ—Ä—à–∞–µ—Ç —Ä–∞–±–æ—Ç—É:
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–∏–≥–Ω–∞–ª–æ–≤ `SIGTERM` –∏ `SIGINT`
- –ó–∞–∫—Ä—ã—Ç–∏–µ HTTP —Å–µ—Ä–≤–µ—Ä–∞ –ø–µ—Ä–µ–¥ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ–º
- –¢–∞–π–º–∞—É—Ç –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è (10 —Å–µ–∫—É–Ω–¥)

### 4. Axios Interceptor —Å Retry –õ–æ–≥–∏–∫–æ–π

–°–æ–∑–¥–∞–Ω —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞–ø—Ä–æ—Å–æ–≤ (`frontend/src/utils/axiosConfig.ts`):
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π retry** –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ—à–∏–±–æ–∫ (502, 503, 504, timeout)
- **–≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞**: 1s, 2s, 4s...
- **–†–∞–∑–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏** –¥–ª—è Analyz (2 –ø–æ–ø—ã—Ç–∫–∏, 2s –∑–∞–¥–µ—Ä–∂–∫–∞) –∏ –æ–±—ã—á–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (3 –ø–æ–ø—ã—Ç–∫–∏, 1s –∑–∞–¥–µ—Ä–∂–∫–∞)
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –≤ development —Ä–µ–∂–∏–º–µ

### 5. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ—Å—Ç–æ—è–Ω–∏—è Analyz

–°–æ–∑–¥–∞–Ω —Å–µ—Ä–≤–∏—Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ (`frontend/src/services/analyzHealth.ts`):
- –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è (–∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥)
- –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö

### 6. –í–∏–∑—É–∞–ª—å–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å–æ—Å—Ç–æ—è–Ω–∏—è

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç `AnalyzHealthIndicator`:
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö
- –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
- –ö–Ω–æ–ø–∫–∞ –¥–ª—è —Ä—É—á–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### Health Check Endpoints

#### Backend
```typescript
GET /health
// –û—Ç–≤–µ—Ç: { status: "healthy", service: "backend", timestamp: "..." }

GET /health/detailed
// –û—Ç–≤–µ—Ç: { 
//   status: "healthy" | "degraded",
//   dependencies: { analyz: { status: "healthy" | "unavailable" } }
// }
```

#### Analyz
```python
GET /health
// –û—Ç–≤–µ—Ç: {
//   "status": "healthy" | "degraded" | "unhealthy",
//   "checks": { "database": "ok", "data_directory": "ok" }
// }
```

### Retry Configuration

```typescript
// –û–±—ã—á–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
- –ü–æ–ø—ã—Ç–æ–∫: 3
- –ó–∞–¥–µ—Ä–∂–∫–∞: 1s, 2s, 4s
- –°—Ç–∞—Ç—É—Å—ã –¥–ª—è retry: 502, 503, 504, 408, 429

// –ó–∞–ø—Ä–æ—Å—ã –∫ Analyz
- –ü–æ–ø—ã—Ç–æ–∫: 2
- –ó–∞–¥–µ—Ä–∂–∫–∞: 2s, 4s
- –°—Ç–∞—Ç—É—Å—ã –¥–ª—è retry: 502, 503, 504
```

### Docker Health Checks

```yaml
healthcheck:
  test: ["CMD", "..."]
  interval: 30s      # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
  timeout: 10s      # –¢–∞–π–º–∞—É—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏
  retries: 3        # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫
  start_period: 40s # –ü–µ—Ä–∏–æ–¥ –∑–∞–ø—É—Å–∫–∞ (–∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è –æ—à–∏–±–∫–∏)
```

## üì¶ –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã

1. `backend/src/routes/health.ts` - Health check endpoints –¥–ª—è backend
2. `frontend/src/utils/axiosConfig.ts` - Axios interceptors —Å retry
3. `frontend/src/services/analyzHealth.ts` - –°–µ—Ä–≤–∏—Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ Analyz
4. `frontend/src/components/AnalyzHealthIndicator.tsx` - –í–∏–∑—É–∞–ª—å–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä

## üîÑ –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

1. `backend/src/index.ts` - –î–æ–±–∞–≤–ª–µ–Ω health route, graceful shutdown
2. `Analyz/app.py` - –î–æ–±–∞–≤–ª–µ–Ω `/health` endpoint
3. `docker-compose.yml` - –î–æ–±–∞–≤–ª–µ–Ω—ã healthchecks –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
4. `frontend/src/App.tsx` - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞
5. `frontend/src/pages/AdminDashboard.tsx` - –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
6. `frontend/src/pages/ManagerDashboard.tsx` - –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

## üöÄ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

1. **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π retry –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–±–æ–µ–≤
2. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: Health checks –ø–æ–∑–≤–æ–ª—è—é—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤
3. **–û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å**: Docker –ø—Ä–∞–≤–∏–ª—å–Ω–æ —É–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
4. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç**: –í–∏–∑—É–∞–ª—å–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –ø—Ä–æ–±–ª–µ–º
5. **–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞**: –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
6. **Graceful shutdown**: –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ –¥–∞–Ω–Ω—ã—Ö

## üìù –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤

```bash
# Backend
curl http://localhost:5000/health
curl http://localhost:5000/health/detailed

# Analyz
curl http://localhost:5050/health
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ Docker

```bash
# –°—Ç–∞—Ç—É—Å health checks
docker compose ps

# –õ–æ–≥–∏ health checks
docker compose events
```

### –í –∫–æ–¥–µ

```typescript
// –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ Analyz
import { analyzHealthMonitor } from './services/analyzHealth';

analyzHealthMonitor.subscribe((status) => {
  console.log('Analyz status:', status);
});

// –†—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
await analyzHealthMonitor.checkHealth();
```

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º

### –ï—Å–ª–∏ Analyz –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `docker compose logs analyz`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ health check: `curl http://localhost:5050/health`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞: `docker compose ps`
4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å: `docker compose restart analyz`

### –ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å—ã –Ω–µ –ø—Ä–æ—Ö–æ–¥—è—Ç

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ axios –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ (development)
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ retry –ª–æ–≥–∏–∫—É - –∑–∞–ø—Ä–æ—Å—ã –¥–æ–ª–∂–Ω—ã –ø–æ–≤—Ç–æ—Ä—è—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ health check backend: `curl http://localhost:5000/health/detailed`

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –≤–Ω–µ—à–Ω–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (Prometheus, Grafana) –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è health checks
2. **–ê–ª–µ—Ä—Ç—ã**: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–æ–≤
3. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (ELK, Loki)
4. **–ú–µ—Ç—Ä–∏–∫–∏**: –î–æ–±–∞–≤—å—Ç–µ –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

- Health checks —Ä–∞–±–æ—Ç–∞—é—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ Docker
- Retry –ª–æ–≥–∏–∫–∞ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫–æ –≤—Å–µ–º –∑–∞–ø—Ä–æ—Å–∞–º —á–µ—Ä–µ–∑ axios
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ Analyz –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö

