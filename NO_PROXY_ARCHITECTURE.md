# –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –±–µ–∑ –¥–≤–æ–π–Ω–æ–≥–æ –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏—è

## –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å

### –ë—ã–ª–æ (—Å –¥–≤–æ–π–Ω—ã–º –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ–º):
```
Frontend ‚Üí Nginx ‚Üí Backend (–ø—Ä–æ–∫—Å–∏) ‚Üí Analyz
Frontend ‚Üí Nginx ‚Üí Backend (API)
```

### –°—Ç–∞–ª–æ (–ø—Ä–æ—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞):
```
Frontend ‚Üí Nginx ‚Üí Backend (API)
Frontend ‚Üí Nginx ‚Üí Analyz (–Ω–∞–ø—Ä—è–º—É—é)
```

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

1. ‚úÖ **–ü—Ä–æ—â–µ** - —É–±—Ä–∞–Ω–æ –¥–≤–æ–π–Ω–æ–µ –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ
2. ‚úÖ **–ë—ã—Å—Ç—Ä–µ–µ** - –º–µ–Ω—å—à–µ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö –∑–≤–µ–Ω—å–µ–≤
3. ‚úÖ **–ù–∞–¥–µ–∂–Ω–µ–µ** - –º–µ–Ω—å—à–µ —Ç–æ—á–µ–∫ –æ—Ç–∫–∞–∑–∞
4. ‚úÖ **–ü–æ–Ω—è—Ç–Ω–µ–µ** - –ø—Ä–æ—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

## –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ

### 1. Backend (`backend/src/index.ts`)
- ‚ùå –£–¥–∞–ª–µ–Ω –ø—Ä–æ–∫—Å–∏ middleware –¥–ª—è Analyz
- ‚úÖ Backend —Ç–µ–ø–µ—Ä—å —Ç–æ–ª—å–∫–æ –¥–ª—è API (`/api/*`)

### 2. Frontend Nginx (`frontend/nginx.conf`)
- ‚úÖ –ü—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ `/integrations/analyz` –Ω–∞–ø—Ä—è–º—É—é –∫ `analyz:5050`
- ‚úÖ –ü–µ—Ä–µ–ø–∏—Å—ã–≤–∞–Ω–∏–µ –ø—É—Ç–∏: `/integrations/analyz/health` ‚Üí `/health`

### 3. Analyz (`Analyz/app.py`)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω CORS –¥–ª—è –ø—Ä—è–º–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ origins

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### Docker Compose
–ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π - –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ —Ä–∞–Ω—å—à–µ.

### Nginx
–¢–µ–ø–µ—Ä—å –ø—Ä–æ–∫—Å–∏—Ä—É–µ—Ç –Ω–∞–ø—Ä—è–º—É—é:
```nginx
location /integrations/analyz {
    proxy_pass http://analyz:5050;
    rewrite ^/integrations/analyz(.*)$ $1 break;
}
```

### CORS –≤ Analyz
–ù–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å frontend:
```python
CORS(app, 
     origins=os.environ.get("CORS_ORIGINS", "*").split(","),
     supports_credentials=True)
```

## –ú–∏–≥—Ä–∞—Ü–∏—è

### –®–∞–≥ 1: –û–±–Ω–æ–≤–∏—Ç–µ –∫–æ–¥
```bash
git pull  # –∏–ª–∏ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
```

### –®–∞–≥ 2: –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
```bash
docker compose build
```

### –®–∞–≥ 3: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ
```bash
docker compose down
docker compose up -d
```

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ nginx
curl http://localhost:3001/integrations/analyz/health

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ø—Ä—è–º—É—é
curl http://localhost:5051/health
```

## –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### Analyz
–ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ `.env` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
```env
CORS_ORIGINS=http://localhost:3001,http://your-domain.com
```

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ä–∞–∑—Ä–µ—à–µ–Ω—ã –≤—Å–µ origins (`*`).

## –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

–í—Å–µ –∑–∞–ø—Ä–æ—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç —Ç–∞–∫ –∂–µ:
- `/integrations/analyz/health` ‚Üí `/health` –≤ Analyz
- `/integrations/analyz/days` ‚Üí `/days` –≤ Analyz
- `/integrations/analyz/employee_stats_today` ‚Üí `/employee_stats_today` –≤ Analyz

## –û—Ç–∫–∞—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏—é —á–µ—Ä–µ–∑ backend:

1. –í–µ—Ä–Ω–∏—Ç–µ –ø—Ä–æ–∫—Å–∏ middleware –≤ `backend/src/index.ts`
2. –ò–∑–º–µ–Ω–∏—Ç–µ nginx –æ–±—Ä–∞—Ç–Ω–æ –Ω–∞ `proxy_pass http://backend:5000`
3. –£–±–µ—Ä–∏—Ç–µ CORS –∏–∑ Analyz (–µ—Å–ª–∏ –Ω–µ –Ω—É–∂–µ–Ω)

–ù–æ –∑–∞—á–µ–º? –ù–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ—â–µ –∏ –ª—É—á—à–µ! üòä

